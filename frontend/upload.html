<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<title>Upload Titles</title>

	<link rel="stylesheet" href="/styles.css">
</head>

<body>

	<div class="container">

		<h2>Upload Titles</h2>

		<p>Select an Excel or CSV file. The backend will extract titles, normalize them and detect duplicates.</p>

		<input type="file" id="fileInput" accept=".xlsx,.xls,.csv">

		<div style="margin-top:15px;">
			<button class="btn-primary" id="uploadBtn">Upload & Process</button>
		</div>

		<div id="loader">Processingâ€¦</div>

		<div id="status" style="margin-top:15px;"></div>

		<a href="/history.html" id="viewLink" style="display:none;" class="btn-neutral">View Results</a>

	</div>

	<script>
		const fileInput = document.getElementById("fileInput");
		const uploadBtn = document.getElementById("uploadBtn");
		const loader = document.getElementById("loader");
		const status = document.getElementById("status");
		const viewLink = document.getElementById("viewLink");

		uploadBtn.onclick = async () => {
			const f = fileInput.files[0];

			if (!f) {
				alert("Choose a file first");
				return;
			}

			uploadBtn.disabled = true;
			loader.style.display = "block";
			status.innerText = "Uploading...";

			const fd = new FormData();
			fd.append("file", f);

			try {
				const res = await fetch("/upload-file", {
					method: "POST",
					body: fd
				});

				const j = await res.json();

				status.innerText = "Done!";
				viewLink.style.display = "inline-block";

			} catch (e) {
				status.innerText = "Error: " + e;
			}

			loader.style.display = "none";
			uploadBtn.disabled = false;
		};
	</script>

</body>

</html>